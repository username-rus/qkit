## Введение
Сервис асинхронных вызовов функций. Представлен QCall(QBox, name, arg), QBack(QBox, res).

## Асинхронная функция
Специально оформленная функция в составе commandant c механизмом отложенного возврата. Один асинхронный вызов при этом разбивается на череду синхронных - первый для обслуживания вызова данной функции, последующие для обслуживания возможных возвратов из асинхронных подвызовов, если такие были. Для отделения и различения одного синхронного вызова от другого используется один большой switch. Асинхронные подвызовы осуществляются по средствам QCall(QBox, name, arg). Отложенный асинхронный возврат по средствам QBack(QBox, res). Асинхронная функция имеет только один аргумент QBox, который так же служит для хранения необходимых переменных, так как синхронный `контекст исполнения` пропадает при синхронном возврате, вместе со всеми "синхронными переменными".

```javascript
QDefine({
	is: 'commandant',
	name: 'My/Сommandant/X'
});

define.fPublicX = function (QBox)
{
	switch (QBox.from)
	{
		//обслуживание вызова данной функции
		case '#': 
			var x = this.fPrivateX_(123);
			
			QCall(QBox, 'My/Сommandant/Y/fPublic', x);
			break;
		
		//обслуживание возврата из подвызова
		case '#My/Сommandant/Y/fPublic':
			var ret = QBox.ret;
			
			QBack(QBox, ret);
			break;
	}
}
define.fPrivateX_ = function (...) {...}
define.dPrivateX_ = {x: 123}
```

## QBox
Единственный параметр асинхронный функции. Необходимо сохранять в замыкании при асинхронных действиях. Можно сохранять необходимые переменные напрямую `QBox.x = 123`. Имена переменных произвольные, за исключением тех что описаны ниже.

* back - ссылается на QBox предыдущего вызова
* name - полное имя текущего вызова (имя сущности + имя метода)
* from - метка для распознавания принадлежности текущего синхронного вызова ( switch(QBox.from) )
* size - счетчики, подсчитывает количество исполненных подвызовов (size[имя_подвызова] == общее_число_исполненных_на_данный_момент)
* size.full - счетчик количества всех исполненных подвызовов
* arg - аргументы данной функции, доступны на протяжении всего асинхронного вызова
* ret - результат работы подвызова, доступен в пределах текущего синхронного вызова.

Следует заметить, что счетчики size считают от нуля, что отличается от предыдущей версии, где считалось к нулю, и можно было узнать остаток подвызовов находящихся на обработке, просто сравнив с нулем. Сравнение с нулем конечно куда более удобное решение, чем подсчет и сравнение каких то произвольных величин, но требует специальной обработки, так как далеко не все асинхронные вызовы на самом деле асинхронны. По тому, это отложено до следующей версии.
При действительно асинхронных действиях, например при использовании XMLHttpRequest, необходимо сохранять QBox в замыкании.

## QCall
Служит для вызова асинхронной функции. Имеет три параметра (QBox, name, arg):
* QBox - QBox текущего вызова либо null в случае первого асинхронного вызова
* name - строка, полное имя асинхронной функции (My/СommandantExample/functionPublic)
* arg - аргументы для вызываемой функции, доступны через QBox.arg

Асинхронную функция можно вызывать не дожидаясь загрузки чего либо, даже вызываемой функции. Поддерживается рекурсия. В целом все так же как при вызове обычной функции.

## QBack
Служит для отложенного возврата (возврата по требованию). Имеет два параметра (QBox, res)
* QBox - QBox текущего вызова либо
* res - возвращаемый результат, доступен через QBox.ret

Возврат можно делать в любой момент, главное что бы не было подвызовов на обработке, в данной версии это не отслеживается. Так же после QBack не должно следовать других команд, сразу break.
